(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9176],{27931:(e,t,s)=>{Promise.resolve().then(s.bind(s,59069))},29869:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},32383:()=>{},35169:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},49026:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>c,TN:()=>d});var r=s(95155),a=s(12115),l=s(74466),i=s(53999);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:a}),s),...l})});c.displayName="Alert",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...a})});d.displayName="AlertDescription"},59069:(e,t,s)=>{"use strict";s.r(t),s.d(t,{addActivity:()=>b,default:()=>k,deleteActivity:()=>j,getActivities:()=>N,updateActivity:()=>w});var r=s(95155),a=s(12115),l=s(35695),i=s(99314),n=s(76037),c=s(97168),d=s(88482),o=s(35169),u=s(85339),m=s(29869),f=s(6874),p=s.n(f),x=s(49026),h=s(58012),v=s(3925),y=s(33168);let g=e=>{if(e)switch(e.trim().toLowerCase()){case"computer":return"Computer";case"laptop":return"Laptop";case"printer":return"Printer";case"scanner":return"Scanner";case"sim card":return"SIM Card";case"office phone":return"Office Phone";case"router":return"Router";case"pocket wifi":return"Pocket Wifi";case"ups":return"UPS";default:return}};async function N(){let{data:e,error:t}=await y.ND.from("activities").select("*").order("id",{ascending:!1});if(t)throw t;return e}async function b(e){let{data:t,error:s}=await y.ND.from("activities").insert([e]).select();if(s)throw s;return t[0]}async function w(e,t){let{data:s,error:r}=await y.ND.from("activities").update(t).eq("id",e).select();if(r)throw r;return s[0]}async function j(e){let{error:t}=await y.ND.from("activities").delete().eq("id",e);if(t)throw t}function k(){let e=(0,l.useRouter)(),{addDevice:t}=(0,h.t)(),[s,f]=(0,a.useState)(null),[N,b]=(0,a.useState)(!1),[w,j]=(0,a.useState)(null),[k,A]=(0,a.useState)(null),[C,S]=(0,a.useState)(0),R=async e=>new Promise((t,s)=>{let r=new FileReader;r.onload=e=>{try{var r;let s=null===(r=e.target)||void 0===r?void 0:r.result,a=v.LF(s,{type:"binary"}),l=a.SheetNames[0],i=a.Sheets[l],n=v.Wp.sheet_to_json(i,{raw:!1});t(n)}catch(e){s(e)}},r.onerror=e=>s(e),r.readAsBinaryString(e)}),T=async r=>{if(r.preventDefault(),!s){j("Please select a file to upload");return}b(!0),j(null),A(null),S(0);try{let r=await R(s),a=0,l=0,i=[];for(let e=0;e<r.length;e++){let s=r[e];try{let r=Object.entries(s).reduce((e,t)=>{let[s,r]=t;return e[s.toLowerCase().trim()]=r,e},{}),l=r.type||r["device type"]||r.devicetype,i={type:g(l),serialNumber:r["serial number"]||r.serialnumber||r.serial||r["seerial number"],modelNumber:r["model number"]||r.modelnumber||r.model||"",assignedTo:r["assigned to"]||r.assignedto||r.assigned||"",status:r.status||"Available",department:r.department||"",warranty:r.warranty||"",dateAssigned:r["date assigned"]||r.dateassigned||r.date||new Date().toISOString().split("T")[0]},n=[];if(i.type||n.push("Type"),i.serialNumber||n.push("Serial Number"),n.length>0)throw Error("Row ".concat(e+2,": Missing required fields: ").concat(n.join(", ")));await t(i),a++}catch(t){console.error("Error processing device at row ".concat(e+2,":"),t),l++,i.push(t.message)}S(Math.round((e+1)/r.length*100))}a>0?(A("Successfully added ".concat(a," devices").concat(l>0?" (".concat(l," failed)"):"")),l>0&&j("Failed to process some devices:\n".concat(i.join("\n"))),setTimeout(()=>{e.push("/devices")},2e3)):j("No devices were successfully added. Please check your Excel file format.")}catch(e){j(e.message||"Failed to process Excel file. Please ensure the file is in the correct format.")}finally{b(!1)}};return(0,a.useEffect)(()=>{y.ND.from("activities").select("*").then(console.log)},[]),(0,r.jsxs)(i.sF,{className:"h-full bg-white",children:[(0,r.jsxs)("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b px-4 bg-white",children:[(0,r.jsx)(i.x2,{className:"-ml-1"}),(0,r.jsx)(n.w,{orientation:"vertical",className:"mr-2 h-4"}),(0,r.jsx)(c.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,r.jsxs)(p(),{href:"/devices",children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Back to Devices"]})}),(0,r.jsx)(n.w,{orientation:"vertical",className:"mr-2 h-4"}),(0,r.jsx)("h1",{className:"text-lg font-semibold",children:"Upload Devices"})]}),(0,r.jsx)("div",{className:"flex flex-1 flex-col gap-6 p-6 max-w-2xl mx-auto bg-white min-h-[calc(100vh-4rem)]",children:(0,r.jsxs)(d.Zp,{className:"border-none shadow-md bg-white",children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Upload Devices from Excel"}),(0,r.jsxs)(d.BT,{children:[(0,r.jsx)("p",{className:"mb-4",children:'Upload your device inventory using an Excel file. The file should contain at least "Type" and "Serial Number". Other fields like "Model Number", "Status", "Assigned To", "Department", "Warranty", and "Date Assigned" are optional.'}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:'Column names are flexible (e.g., "Type", "Device Type", or "DeviceType").'})]})]}),(0,r.jsxs)(d.Wu,{children:[w&&(0,r.jsxs)(x.Fc,{variant:"destructive",className:"mb-6 whitespace-pre-line",children:[(0,r.jsx)(u.A,{className:"h-4 w-4"}),(0,r.jsx)(x.TN,{children:w})]}),k&&(0,r.jsxs)(x.Fc,{className:"mb-6 bg-green-50 text-green-800 border-green-200",children:[(0,r.jsx)(u.A,{className:"h-4 w-4"}),(0,r.jsx)(x.TN,{children:k})]}),(0,r.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-6 text-center",children:[(0,r.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===s.type||"application/vnd.ms-excel"===s.type?(f(s),j(null)):(j("Please upload an Excel file (.xlsx or .xls)"),f(null)))},className:"hidden",id:"file-upload"}),(0,r.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[(0,r.jsx)(m.A,{className:"h-8 w-8 text-gray-400 mb-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:s?s.name:"Click to select Excel file"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Supports .xlsx and .xls files"})]})]}),N&&(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(C,"%")}})})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)(c.$,{type:"submit",disabled:N||!s,children:N?"Uploading...":"Upload File"}),(0,r.jsx)(c.$,{asChild:!0,variant:"outline",type:"button",disabled:N,children:(0,r.jsx)(p(),{href:"/devices",children:"Cancel"})})]})]})]})]})})]})}},83686:()=>{},85339:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(19946).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},88482:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>i,aR:()=>n});var r=s(95155),a=s(12115),l=s(53999);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});n.displayName="CardHeader";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});c.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"}},e=>{var t=t=>e(e.s=t);e.O(0,[3524,8110,2939,8370,6874,4075,8441,1684,7358],()=>t(27931)),_N_E=e.O()}]);