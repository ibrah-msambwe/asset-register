(()=>{var e={};e.id=176,e.ids=[176],e.modules={3018:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>l,TN:()=>d});var s=r(60687),i=r(43210),a=r(24224),n=r(96241);let o=(0,a.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=i.forwardRef(({className:e,variant:t,...r},i)=>(0,s.jsx)("div",{ref:i,role:"alert",className:(0,n.cn)(o({variant:t}),e),...r}));l.displayName="Alert",i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("h5",{ref:r,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",e),...t})).displayName="AlertTitle";let d=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",e),...t}));d.displayName="AlertDescription"},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},16023:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28559:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},28971:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addActivity:()=>a,default:()=>l,deleteActivity:()=>o,getActivities:()=>i,updateActivity:()=>n});var s=r(12907);let i=(0,s.registerClientReference)(function(){throw Error("Attempted to call getActivities() from the server but getActivities is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx","getActivities"),a=(0,s.registerClientReference)(function(){throw Error("Attempted to call addActivity() from the server but addActivity is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx","addActivity"),n=(0,s.registerClientReference)(function(){throw Error("Attempted to call updateActivity() from the server but updateActivity is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx","updateActivity"),o=(0,s.registerClientReference)(function(){throw Error("Attempted to call deleteActivity() from the server but deleteActivity is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx","deleteActivity"),l=(0,s.registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Administrator_1\\\\Desktop\\\\asset-register\\\\app\\\\(protected)\\\\devices\\\\upload\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx","default")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},36925:(e,t,r)=>{Promise.resolve().then(r.bind(r,28971))},51944:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(37413);function i(){return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"h-8 w-8 animate-spin mx-auto mb-4 rounded-full border-2 border-purple-600 border-t-transparent"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading Devices..."})]})})}},55192:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>o});var s=r(60687),i=r(43210),a=r(96241);let n=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let o=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",e),...t}));o.displayName="CardHeader";let l=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let d=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",i.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,a.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},55485:(e,t,r)=>{Promise.resolve().then(r.bind(r,73830))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64999:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d});var s=r(65239),i=r(48088),a=r(88170),n=r.n(a),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d={children:["",{children:["(protected)",{children:["devices",{children:["upload",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,28971)),"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx"]}]},{}]},{loading:[()=>Promise.resolve().then(r.bind(r,51944)),"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,96612)),"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\Administrator_1\\Desktop\\asset-register\\app\\(protected)\\devices\\upload\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/(protected)/devices/upload/page",pathname:"/devices/upload",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},73830:(e,t,r)=>{"use strict";r.r(t),r.d(t,{addActivity:()=>w,default:()=>A,deleteActivity:()=>j,getActivities:()=>b,updateActivity:()=>N});var s=r(60687),i=r(43210),a=r(16189),n=r(57452),o=r(78377),l=r(24934),d=r(55192),c=r(28559),p=r(93613),u=r(16023),m=r(85814),x=r.n(m),f=r(3018),h=r(49522),v=r(33103),g=r(16396);let y=e=>{if(e)switch(e.trim().toLowerCase()){case"computer":return"Computer";case"laptop":return"Laptop";case"printer":return"Printer";case"scanner":return"Scanner";case"sim card":return"SIM Card";case"office phone":return"Office Phone";case"router":return"Router";case"pocket wifi":return"Pocket Wifi";case"ups":return"UPS";default:return}};async function b(){let{data:e,error:t}=await g.ND.from("activities").select("*").order("id",{ascending:!1});if(t)throw t;return e}async function w(e){let{data:t,error:r}=await g.ND.from("activities").insert([e]).select();if(r)throw r;return t[0]}async function N(e,t){let{data:r,error:s}=await g.ND.from("activities").update(t).eq("id",e).select();if(s)throw s;return r[0]}async function j(e){let{error:t}=await g.ND.from("activities").delete().eq("id",e);if(t)throw t}function A(){let e=(0,a.useRouter)(),{addDevice:t}=(0,h.t)(),[r,m]=(0,i.useState)(null),[g,b]=(0,i.useState)(!1),[w,N]=(0,i.useState)(null),[j,A]=(0,i.useState)(null),[C,k]=(0,i.useState)(0),P=async e=>new Promise((t,r)=>{let s=new FileReader;s.onload=e=>{try{let r=e.target?.result,s=v.LF(r,{type:"binary"}),i=s.SheetNames[0],a=s.Sheets[i],n=v.Wp.sheet_to_json(a,{raw:!1});t(n)}catch(e){r(e)}},s.onerror=e=>r(e),s.readAsBinaryString(e)}),_=async s=>{if(s.preventDefault(),!r){N("Please select a file to upload");return}b(!0),N(null),A(null),k(0);try{let s=await P(r),i=0,a=0,n=[];for(let e=0;e<s.length;e++){let r=s[e];try{let s=Object.entries(r).reduce((e,[t,r])=>(e[t.toLowerCase().trim()]=r,e),{}),a=s.type||s["device type"]||s.devicetype,n={type:y(a),serialNumber:s["serial number"]||s.serialnumber||s.serial||s["seerial number"],modelNumber:s["model number"]||s.modelnumber||s.model||"",assignedTo:s["assigned to"]||s.assignedto||s.assigned||"",status:s.status||"Available",department:s.department||"",warranty:s.warranty||"",dateAssigned:s["date assigned"]||s.dateassigned||s.date||new Date().toISOString().split("T")[0]},o=[];if(n.type||o.push("Type"),n.serialNumber||o.push("Serial Number"),o.length>0)throw Error(`Row ${e+2}: Missing required fields: ${o.join(", ")}`);await t(n),i++}catch(t){console.error(`Error processing device at row ${e+2}:`,t),a++,n.push(t.message)}k(Math.round((e+1)/s.length*100))}i>0?(A(`Successfully added ${i} devices${a>0?` (${a} failed)`:""}`),a>0&&N(`Failed to process some devices:
${n.join("\n")}`),setTimeout(()=>{e.push("/devices")},2e3)):N("No devices were successfully added. Please check your Excel file format.")}catch(e){N(e.message||"Failed to process Excel file. Please ensure the file is in the correct format.")}finally{b(!1)}};return(0,s.jsxs)(n.sF,{className:"h-full bg-white",children:[(0,s.jsxs)("header",{className:"flex h-16 shrink-0 items-center gap-2 border-b px-4 bg-white",children:[(0,s.jsx)(n.x2,{className:"-ml-1"}),(0,s.jsx)(o.w,{orientation:"vertical",className:"mr-2 h-4"}),(0,s.jsx)(l.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,s.jsxs)(x(),{href:"/devices",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Back to Devices"]})}),(0,s.jsx)(o.w,{orientation:"vertical",className:"mr-2 h-4"}),(0,s.jsx)("h1",{className:"text-lg font-semibold",children:"Upload Devices"})]}),(0,s.jsx)("div",{className:"flex flex-1 flex-col gap-6 p-6 max-w-2xl mx-auto bg-white min-h-[calc(100vh-4rem)]",children:(0,s.jsxs)(d.Zp,{className:"border-none shadow-md bg-white",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{children:"Upload Devices from Excel"}),(0,s.jsxs)(d.BT,{children:[(0,s.jsx)("p",{className:"mb-4",children:'Upload your device inventory using an Excel file. The file should contain at least "Type" and "Serial Number". Other fields like "Model Number", "Status", "Assigned To", "Department", "Warranty", and "Date Assigned" are optional.'}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:'Column names are flexible (e.g., "Type", "Device Type", or "DeviceType").'})]})]}),(0,s.jsxs)(d.Wu,{children:[w&&(0,s.jsxs)(f.Fc,{variant:"destructive",className:"mb-6 whitespace-pre-line",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),(0,s.jsx)(f.TN,{children:w})]}),j&&(0,s.jsxs)(f.Fc,{className:"mb-6 bg-green-50 text-green-800 border-green-200",children:[(0,s.jsx)(p.A,{className:"h-4 w-4"}),(0,s.jsx)(f.TN,{children:j})]}),(0,s.jsxs)("form",{onSubmit:_,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-200 rounded-lg p-6 text-center",children:[(0,s.jsx)("input",{type:"file",accept:".xlsx,.xls",onChange:e=>{let t=e.target.files?.[0];t&&("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===t.type||"application/vnd.ms-excel"===t.type?(m(t),N(null)):(N("Please upload an Excel file (.xlsx or .xls)"),m(null)))},className:"hidden",id:"file-upload"}),(0,s.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center justify-center",children:[(0,s.jsx)(u.A,{className:"h-8 w-8 text-gray-400 mb-2"}),(0,s.jsx)("span",{className:"text-sm text-gray-600",children:r?r.name:"Click to select Excel file"}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Supports .xlsx and .xls files"})]})]}),g&&(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${C}%`}})})]}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsx)(l.$,{type:"submit",disabled:g||!r,children:g?"Uploading...":"Upload File"}),(0,s.jsx)(l.$,{asChild:!0,variant:"outline",type:"button",disabled:g,children:(0,s.jsx)(x(),{href:"/devices",children:"Cancel"})})]})]})]})]})})]})}},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},93613:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[357,196,890,321,828,15,103,489],()=>r(64999));module.exports=s})();